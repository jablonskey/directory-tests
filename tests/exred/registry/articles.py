# -*- coding: utf-8 -*-
"""ExRed Articles Registry"""

ARTICLES = {
    "analyse the competition": {
        "time to read": 0,
        "guidance": {
            "market research": {
                "index": 4,
                "previous": "do field research",
                "next": "visit a trade show"
            }
        },
    },
    "borrow against assets": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 5,
                "previous": "raise money by borrowing",
                "next": None
            }
        },
    },
    "choose the right finance": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 2,
                "previous": "get money to export",
                "next": "get export finance"
            }
        },
    },
    "choosing an agent or distributor": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 5,
                "previous": "use a distributor",
                "next": "licensing and franchising"
            }
        },
    },
    "consider how you'll get paid": {
        "time to read": 0,
        "guidance": {
            "getting paid": {
                "index": 1,
                "previous": None,
                "next": "invoice currency and contents"
            }
        },
    },
    "decide when you'll get paid": {
        "time to read": 0,
        "guidance": {
            "getting paid": {
                "index": 3,
                "previous": "invoice currency and contents",
                "next": "payment methods"
            }
        },
    },
    "define market potential": {
        "time to read": 0,
        "guidance": {
            "market research": {
                "index": 2,
                "previous": "do research first",
                "next": "do field research"
            }
        },
    },
    "do field research": {
        "time to read": 0,
        "guidance": {
            "market research": {
                "index": 3,
                "previous": "define market potential",
                "next": "analyse the competition"
            }
        },
    },
    "do research first": {
        "time to read": 0,
        "guidance": {
            "market research": {
                "index": 1,
                "previous": None,
                "next": "define market potential"
            }
        },
    },
    "find a route to market": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 2,
                "previous": "make an export plan",
                "next": "use an overseas agent"
            }
        },
    },
    "franchise your business": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 8,
                "previous": "license your product or service",
                "next": "start a joint venture"
            }
        },
    },
    "get export finance": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 3,
                "previous": "choose the right finance",
                "next": "raise money by borrowing"
            }
        },
    },
    "get government finance support": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 7,
                "previous": "raise money with investment",
                "next": None
            }
        },
    },
    "get money to export": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 1,
                "previous": None,
                "next": "choose the right finance"
            }
        },
    },
    "get your export documents right": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 4,
                "previous": "user incoterms in contracts",
                "next": "match your website to your audience"
            }
        },
    },
    "ip protection in multiple countries": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 10,
                "previous": "know what IP you have",
                "next": None
            }
        },
    },
    "insure against non-payment": {
        "time to read": 0,
        "guidance": {
            "getting paid": {
                "index": 5,
                "previous": "payment methods",
                "next": None
            }
        },
    },
    "internationalise your website": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 6,
                "previous": "match your website to your audience",
                "next": "what intellectual property is"
            }
        },
    },
    "invoice currency and contents": {
        "time to read": 0,
        "guidance": {
            "getting paid": {
                "index": 2,
                "previous": "consider how you'll get paid",
                "next": "decide when you'll get paid"
            }
        },
    },
    "know what ip you have": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 9,
                "previous": "types of intellectual property",
                "next": "ip protection in multiple countries"
            }
        },
    },
    "know your customers": {
        "time to read": 0,
        "guidance": {
            "customer insight": {
                "index": 1,
                "previous": None,
                "next": "meet your customers"
            }
        },
    },
    "licensing and franchising": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 6,
                "previous": "choosing an agent or distributor",
                "next": "license your product or service"
            }
        },
    },
    "license your product or service": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 7,
                "previous": "licensing and franchising",
                "next": "franchise your business"
            }
        },
    },
    "make an export plan": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 1,
                "previous": None,
                "next": "find a route to market"
            }
        },
    },
    "manage language differences": {
        "time to read": 0,
        "guidance": {
            "customer insight": {
                "index": 3,
                "previous": "meet your customers",
                "next": "Understand your customer's culture"
            }
        },
    },
    "match your website to your audience": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 5,
                "previous": "get your export documents right",
                "next": "internationalise your website"
            }
        },
    },
    "meet your customers": {
        "time to read": 0,
        "guidance": {
            "customer insight": {
                "index": 2,
                "previous": "meet your customers",
                "next": "manage language differences"
            }
        },
    },
    "payment methods": {
        "time to read": 0,
        "guidance": {
            "getting paid": {
                "index": 4,
                "previous": "decide when you'll get paid",
                "next": "insure against non-payment"
            }
        },
    },
    "plan the logistics": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 1,
                "previous": None,
                "next": "use a freight forwarder"
            }
        },
    },
    "raise money by borrowing": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 4,
                "previous": "get export finance",
                "next": "borrow against assets"
            }
        },
    },
    "raise money with investment": {
        "time to read": 0,
        "guidance": {
            "finance": {
                "index": 6,
                "previous": None,
                "next": None
            }
        },
    },
    "set up an overseas operation": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 10,
                "previous": "start a joint venture",
                "next": None
            }
        },
    },
    "start a joint venture": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 9,
                "previous": "franchise your business",
                "next": "set up an overseas operation"
            }
        },
    },
    "types of intellectual property": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 8,
                "previous": "what intellectual property is",
                "next": "know what IP you have"
            }
        },
    },
    "understand your customer's culture": {
        "time to read": 0,
        "guidance": {
            "customer insight": {
                "index": 4,
                "previous": "manage language differences",
                "next": None
            }
        },
    },
    "use a distributor": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 4,
                "previous": "use an overseas agent",
                "next": "choosing an agent or distributor"
            }
        },
    },
    "use a freight forwarder": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 2,
                "previous": "plan the logistics",
                "next": "user incoterms in contracts"
            }
        },
    },
    "use an overseas agent": {
        "time to read": 0,
        "guidance": {
            "business planning": {
                "index": 3,
                "previous": "find a route to market",
                "next": "use a distributor"
            }
        },
    },
    "user incoterms in contracts": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 3,
                "previous": "use a freight forwarder",
                "next": "get your export documents right"
            }
        },
    },
    "visit a trade show": {
        "time to read": 0,
        "guidance": {
            "market research": {
                "index": 5,
                "previous": "analyse the competition",
                "next": None
            }
        },
    },
    "what intellectual property is": {
        "time to read": 0,
        "guidance": {
            "operations and compliance": {
                "index": 7,
                "previous": "internationalise your website",
                "next": "types of intellectual property"
            }
        },
    },
}


def filter_articles(group: str, category: str) -> list:
    """Filter articles by group and category.

    :param group: Article Group: Guidance, Export Readiness, Triage
    :param category: Category of Articles that belong to a specific Group
    :return: a list of matching Article dictionaries
    """
    filtered = [{
        name: {
            "index": ARTICLES[name][group][category]["index"],
            "time to read": ARTICLES[name]["time to read"],
            "previous": ARTICLES[name][group][category]["previous"],
            "next": ARTICLES[name][group][category]["next"],
        }} for name in ARTICLES if
        group in ARTICLES[name] and category in ARTICLES[name][group]]
    return filtered


def get_article_index(dictionary: dict) -> int:
    """Get Article index. Handy when sorting articles by index.

    :param dictionary: a dict with one key and dict as value that has index key
    :return: the article index value
    """
    return list(dictionary.values())[0]['index']


def get_articles(group: str, category: str) -> list:
    """Find matching articles and sort them by their category index.

    :param group: Article Group: Guidance, Export Readiness, Triage
    :param category: Category of Articles that belong to a specific Group
    :return: a list of matching Article sorted by their category index
    """
    filtered = filter_articles(group, category)
    return sorted(filtered, key=get_article_index)
